<div class="page-header">
  <div class="container">
    <h1><%= category.name %></h1>
    <% if (category.description) { %>
      <p><%= category.description %></p>
    <% } %>
    <div class="category-stats">
      <span class="product-count"><%= category.product_count || 0 %> products available</span>
    </div>
  </div>
</div>

<section class="category-products-section">
  <div class="container">
    <div class="products-controls">
      <div class="search-filter">
        <input type="text" id="product-search" placeholder="Search in <%= category.name %>..." class="search-input">
        <button id="search-btn" class="btn btn-primary">
          <i class="fas fa-search"></i> Search
        </button>
      </div>

      <div class="sort-filter">
        <label for="sort-select">Sort by:</label>
        <select id="sort-select" class="sort-select">
          <option value="newest">Newest First</option>
          <option value="price-low">Price: Low to High</option>
          <option value="price-high">Price: High to Low</option>
          <option value="name">Name A-Z</option>
        </select>
      </div>
    </div>

    <div class="products-grid" id="products-grid">
      <% if (typeof products !== 'undefined' && products.length > 0) { %>
        <% products.forEach(product => { %>
          <div class="product-card" data-product-id="<%= product.id %>">
            <div class="product-image">
              <% if (product.image_url) { %>
                <img src="<%= product.image_url %>" alt="<%= product.name %>" loading="lazy">
              <% } else { %>
                <div class="no-image">
                  <i class="fas fa-image"></i>
                </div>
              <% } %>
              <% if (product.is_featured) { %>
                <span class="featured-badge">Featured</span>
              <% } %>
              <% if (product.is_new) { %>
                <span class="new-badge">New</span>
              <% } %>
            </div>
            <div class="product-info">
              <h3 class="product-name">
                <a href="/products/<%= product.slug || product.id %>"><%= product.name %></a>
              </h3>
              <div class="product-price">
                <% if (product.discount_percentage > 0) { %>
                  <span class="original-price">$<%= product.price %></span>
                  <span class="current-price">$<%= (product.price * (1 - product.discount_percentage / 100)).toFixed(2) %></span>
                  <span class="discount-badge"><%= product.discount_percentage %>% OFF</span>
                <% } else { %>
                  <span class="current-price">$<%= product.price %></span>
                <% } %>
              </div>
              <div class="product-meta">
                <% if (product.brand) { %>
                  <span class="brand">by <%= product.brand %></span>
                <% } %>
              </div>
              <div class="product-stock">
                <% if (product.stock_quantity > 0) { %>
                  <span class="in-stock">In Stock (<%= product.stock_quantity %> available)</span>
                <% } else { %>
                  <span class="out-of-stock">Out of Stock</span>
                <% } %>
              </div>
              <div class="product-actions">
                <a href="/products/<%= product.slug || product.id %>" class="btn btn-primary">View Details</a>
                <% if (product.stock_quantity > 0) { %>
                  <button class="btn btn-secondary add-to-cart-btn" data-product-id="<%= product.id %>">
                    <i class="fas fa-cart-plus"></i> Add to Cart
                  </button>
                <% } %>
              </div>
            </div>
          </div>
        <% }); %>
      <% } else { %>
        <div class="no-products">
          <i class="fas fa-box-open"></i>
          <h3>No products in this category</h3>
          <p>Products will be added to this category soon. Check back later!</p>
          <div class="alternative-actions">
            <a href="/products" class="btn btn-primary">View All Products</a>
            <a href="/categories" class="btn btn-secondary">Browse Other Categories</a>
          </div>
        </div>
      <% } %>
    </div>
  </div>
</section>

<% if (typeof products !== 'undefined' && products.length > 0) { %>
<section class="related-categories-section">
  <div class="container">
    <div class="section-header">
      <h2>Other Categories</h2>
      <p>Explore more product categories</p>
    </div>

    <div class="categories-grid">
      <div class="category-card">
        <div class="category-image">
          <i class="fab fa-apple"></i>
        </div>
        <div class="category-info">
          <h3 class="category-name">
            <a href="/categories/apple">Apple Products</a>
          </h3>
          <p class="category-description">Genuine Apple parts and accessories</p>
          <div class="category-actions">
            <a href="/categories/apple" class="btn btn-secondary">Browse</a>
          </div>
        </div>
      </div>

      <div class="category-card">
        <div class="category-image">
          <i class="fas fa-mobile-alt"></i>
        </div>
        <div class="category-info">
          <h3 class="category-name">
            <a href="/categories/android">Android Parts</a>
          </h3>
          <p class="category-description">High-quality parts for Android devices</p>
          <div class="category-actions">
            <a href="/categories/android" class="btn btn-secondary">Browse</a>
          </div>
        </div>
      </div>

      <div class="category-card">
        <div class="category-image">
          <i class="fas fa-tools"></i>
        </div>
        <div class="category-info">
          <h3 class="category-name">
            <a href="/categories/tools">Repair Tools</a>
          </h3>
          <p class="category-description">Professional repair tools and equipment</p>
          <div class="category-actions">
            <a href="/categories/tools" class="btn btn-secondary">Browse</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<% } %>
