module.exports=[751604,t=>{"use strict";var e=t.i(747909),s=t.i(174017),i=t.i(996250),a=t.i(759756),r=t.i(561916),n=t.i(114444),h=t.i(837092),u=t.i(869741),o=t.i(316795),d=t.i(487718),p=t.i(995169),c=t.i(47587),l=t.i(666012),g=t.i(570101),y=t.i(626937),R=t.i(10372),w=t.i(193695);t.i(52474);var q=t.i(600220),m=t.i(89171);class b extends Error{name="MeiliSearchError"}class x extends b{name="MeiliSearchApiError";cause;response;constructor(t,e){super(e?.message??`${t.status}: ${t.statusText}`),this.response=t,void 0!==e&&(this.cause=e)}}class f extends b{name="MeiliSearchRequestError";constructor(t,e){super(`Request to ${t} has failed`,{cause:e})}}class T extends b{name="MeiliSearchRequestTimeOutError";cause;constructor(t,e){super(`request timed out after ${t}ms`),this.cause={timeout:t,requestInit:e}}}class k extends b{name="MeiliSearchTaskTimeOutError";cause;constructor(t,e){super(`timeout of ${e}ms has exceeded on task ${t} when waiting for it to be resolved.`),this.cause={taskUid:t,timeout:e}}}let $=Symbol("<timeout>");function v(t,e){let{signal:s}=t,i=new AbortController;if(null!=s){let t=null;if(s.aborted)i.abort(s.reason);else{let e=()=>i.abort(s.reason);s.addEventListener("abort",e,{once:!0}),t=()=>s.removeEventListener("abort",e),i.signal.addEventListener("abort",t,{once:!0})}return()=>{if(s.aborted)return;let a=setTimeout(()=>i.abort($),e),r=()=>{clearTimeout(a),null!==t&&i.signal.removeEventListener("abort",t)};return s.addEventListener("abort",r,{once:!0}),()=>{s.removeEventListener("abort",r),r()}}}return t.signal=i.signal,()=>{let t=setTimeout(()=>i.abort($),e);return()=>clearTimeout(t)}}class S{#t;#e;#s;#i;constructor(t){const e=function(t){return t.endsWith("/")||(t+="/"),t}(function(t){return t.startsWith("https://")||t.startsWith("http://")?t:`http://${t}`}(t.host));try{this.#t=new URL(e)}catch(t){throw new b("The provided host is not valid",{cause:t})}this.#e={...t.requestInit,headers:function(t,e){let s="X-Meilisearch-Client",i="Meilisearch JavaScript (v0.54.0)",a="Content-Type",r="Authorization",n=new Headers(e);if(t.apiKey&&!n.has(r)&&n.set(r,`Bearer ${t.apiKey}`),n.has(a)||n.set(a,"application/json"),void 0!==t.clientAgents){let e=t.clientAgents.concat(i);n.set(s,e.join(" ; "))}else n.set(s,i);return n}(t,t.requestInit?.headers)},this.#s=t.httpClient,this.#i=t.timeout}#a(t,e){if(void 0===t&&void 0===e)return this.#e.headers;let s=new Headers(t);for(let[t,i]of(void 0===e||s.has("Content-Type")||s.set("Content-Type",e),this.#e.headers))s.has(t)||s.set(t,i);return s}#r({path:t,method:e,params:s,contentType:i,body:a,extraRequestInit:r}){let n=new URL(t,this.#t);return void 0!==s&&function(t,e){for(let[s,i]of Object.entries(e))null!=i&&t.set(s,Array.isArray(i)?i.join():i instanceof Date?i.toISOString():String(i))}(n.searchParams,s),{url:n,init:{method:e,body:void 0===i||"string"!=typeof a?JSON.stringify(a):a,...r,...this.#e,headers:this.#a(r?.headers,i)}}}async #n(t){let e,s,{url:i,init:a}=this.#r(t),r=void 0!==this.#i?v(a,this.#i):null,n=r?.();try{if(void 0!==this.#s)return await this.#s(i,a);e=await fetch(i,a),s=await e.text()}catch(t){throw new f(i.toString(),Object.is(t,$)?new T(this.#i,a):t)}finally{n?.()}let h=""===s?void 0:JSON.parse(s);if(!e.ok)throw new x(e,h);return h}get(t){return this.#n(t)}post(t){return this.#n({...t,method:"POST"})}put(t){return this.#n({...t,method:"PUT"})}patch(t){return this.#n({...t,method:"PATCH"})}delete(t){return this.#n({...t,method:"DELETE"})}postStream(t){return this.#h({...t,method:"POST"})}async #h(t){let e,{url:s,init:i}=this.#r(t),a=void 0!==this.#i?v(i,this.#i):null,r=a?.();try{if(void 0!==this.#s){let t=await this.#s(s,i);if(!(t instanceof ReadableStream))throw new b("Custom HTTP client must return a ReadableStream for streaming requests");return t}e=await fetch(s,i)}catch(t){throw new f(s.toString(),Object.is(t,$)?new T(this.#i,i):t)}finally{r?.()}if(!e.ok){let t=await e.text();throw new x(e,""===t?void 0:JSON.parse(t))}if(!e.body)throw new b("Response body is null - server did not return a readable stream");return e.body}}let A=Symbol("<task timeout>");function W(t){return function(e){return Object.defineProperty(e,"waitTask",{value:async s=>await t.waitForTask(await e,s)})}}class E{#u;#o;#d;#p;constructor(t,e){this.#u=t,this.#o=e?.timeout??5e3,this.#d=e?.interval??50,this.#p=W(this)}async getTask(t,e){return await this.#u.get({path:`tasks/${t}`,extraRequestInit:e})}async getTasks(t){return await this.#u.get({path:"tasks",params:t})}async waitForTask(t,e){let s="number"==typeof t?t:t.taskUid,i=e?.timeout??this.#o,a=e?.interval??this.#d,r=i>0?new AbortController:null,n=null!==r?setTimeout(()=>void r.abort(A),i):void 0;try{for(;;){let t=await this.getTask(s,{signal:r?.signal});if("enqueued"!==t.status&&"processing"!==t.status)return clearTimeout(n),t;a>0&&await new Promise(t=>setTimeout(t,a))}}catch(t){throw Object.is(t.cause,A)?new k(s,i):t}}async *waitForTasksIter(t,e){for await(let s of t)yield await this.waitForTask(s,e)}async waitForTasks(...t){let e=[];for await(let s of this.waitForTasksIter(...t))e.push(s);return e}cancelTasks(t){return this.#p(this.#u.post({path:"tasks/cancel",params:t}))}deleteTasks(t){return this.#p(this.#u.delete({path:"tasks",params:t}))}}function C(t,e){let s=W(e);return{post:(...e)=>s(t.post(...e)),put:(...e)=>s(t.put(...e)),patch:(...e)=>s(t.patch(...e)),delete:(...e)=>s(t.delete(...e))}}class I{uid;primaryKey;createdAt;updatedAt;httpRequest;tasks;#c;constructor(t,e,s){this.uid=e,this.primaryKey=s,this.httpRequest=new S(t),this.tasks=new E(this.httpRequest,t.defaultWaitOptions),this.#c=C(this.httpRequest,this.tasks)}async search(t,e,s){return await this.httpRequest.post({path:`indexes/${this.uid}/search`,body:{q:t,...e},extraRequestInit:s})}async searchGet(t,e,s){let i={q:t,...e,filter:(t=>{if("string"==typeof t)return t;if(Array.isArray(t))throw new b("The filter query parameter should be in string format when using searchGet")})(e?.filter),sort:e?.sort?.join(","),facets:e?.facets?.join(","),attributesToRetrieve:e?.attributesToRetrieve?.join(","),attributesToCrop:e?.attributesToCrop?.join(","),attributesToHighlight:e?.attributesToHighlight?.join(","),vector:e?.vector?.join(","),attributesToSearchOn:e?.attributesToSearchOn?.join(",")};return await this.httpRequest.get({path:`indexes/${this.uid}/search`,params:i,extraRequestInit:s})}async searchForFacetValues(t,e){return await this.httpRequest.post({path:`indexes/${this.uid}/facet-search`,body:t,extraRequestInit:e})}async searchSimilarDocuments(t){return await this.httpRequest.post({path:`indexes/${this.uid}/similar`,body:t})}async getRawInfo(){let t=await this.httpRequest.get({path:`indexes/${this.uid}`});return this.primaryKey=t.primaryKey,this.updatedAt=new Date(t.updatedAt),this.createdAt=new Date(t.createdAt),t}async fetchInfo(){return await this.getRawInfo(),this}async fetchPrimaryKey(){return this.primaryKey=(await this.getRawInfo()).primaryKey,this.primaryKey}static create(t,e={},s){let i=new S(s);return C(i,new E(i)).post({path:"indexes",body:{...e,uid:t}})}update(t){return this.#c.patch({path:`indexes/${this.uid}`,body:t})}delete(){return this.#c.delete({path:`indexes/${this.uid}`})}async getStats(){return await this.httpRequest.get({path:`indexes/${this.uid}/stats`})}async getDocuments(t){let e=`indexes/${this.uid}/documents`;return t?.filter!==void 0?await this.httpRequest.post({path:`${e}/fetch`,body:t}):await this.httpRequest.get({path:e,params:t})}async getDocument(t,e){let s=Array.isArray(e?.fields)?e.fields.join():void 0;return await this.httpRequest.get({path:`indexes/${this.uid}/documents/${t}`,params:{...e,fields:s}})}addDocuments(t,e){return this.#c.post({path:`indexes/${this.uid}/documents`,params:e,body:t})}addDocumentsFromString(t,e,s){return this.#c.post({path:`indexes/${this.uid}/documents`,body:t,params:s,contentType:e})}addDocumentsInBatches(t,e=1e3,s){let i=[];for(let a=0;a<t.length;a+=e)i.push(this.addDocuments(t.slice(a,a+e),s));return i}updateDocuments(t,e){return this.#c.put({path:`indexes/${this.uid}/documents`,params:e,body:t})}updateDocumentsInBatches(t,e=1e3,s){let i=[];for(let a=0;a<t.length;a+=e)i.push(this.updateDocuments(t.slice(a,a+e),s));return i}updateDocumentsFromString(t,e,s){return this.#c.put({path:`indexes/${this.uid}/documents`,body:t,params:s,contentType:e})}deleteDocument(t){return this.#c.delete({path:`indexes/${this.uid}/documents/${t}`})}deleteDocuments(t){let e=!Array.isArray(t)&&"object"==typeof t;return this.#c.post({path:`indexes/${this.uid}/${e?"documents/delete":"documents/delete-batch"}`,body:t})}deleteAllDocuments(){return this.#c.delete({path:`indexes/${this.uid}/documents`})}updateDocumentsByFunction(t){return this.#c.post({path:`indexes/${this.uid}/documents/edit`,body:t})}async getSettings(){return await this.httpRequest.get({path:`indexes/${this.uid}/settings`})}updateSettings(t){return this.#c.patch({path:`indexes/${this.uid}/settings`,body:t})}resetSettings(){return this.#c.delete({path:`indexes/${this.uid}/settings`})}async getPagination(){return await this.httpRequest.get({path:`indexes/${this.uid}/settings/pagination`})}updatePagination(t){return this.#c.patch({path:`indexes/${this.uid}/settings/pagination`,body:t})}resetPagination(){return this.#c.delete({path:`indexes/${this.uid}/settings/pagination`})}async getSynonyms(){return await this.httpRequest.get({path:`indexes/${this.uid}/settings/synonyms`})}updateSynonyms(t){return this.#c.put({path:`indexes/${this.uid}/settings/synonyms`,body:t})}resetSynonyms(){return this.#c.delete({path:`indexes/${this.uid}/settings/synonyms`})}async getStopWords(){return await this.httpRequest.get({path:`indexes/${this.uid}/settings/stop-words`})}updateStopWords(t){return this.#c.put({path:`indexes/${this.uid}/settings/stop-words`,body:t})}resetStopWords(){return this.#c.delete({path:`indexes/${this.uid}/settings/stop-words`})}async getRankingRules(){return await this.httpRequest.get({path:`indexes/${this.uid}/settings/ranking-rules`})}updateRankingRules(t){return this.#c.put({path:`indexes/${this.uid}/settings/ranking-rules`,body:t})}resetRankingRules(){return this.#c.delete({path:`indexes/${this.uid}/settings/ranking-rules`})}async getDistinctAttribute(){return await this.httpRequest.get({path:`indexes/${this.uid}/settings/distinct-attribute`})}updateDistinctAttribute(t){return this.#c.put({path:`indexes/${this.uid}/settings/distinct-attribute`,body:t})}resetDistinctAttribute(){return this.#c.delete({path:`indexes/${this.uid}/settings/distinct-attribute`})}async getFilterableAttributes(){return await this.httpRequest.get({path:`indexes/${this.uid}/settings/filterable-attributes`})}updateFilterableAttributes(t){return this.#c.put({path:`indexes/${this.uid}/settings/filterable-attributes`,body:t})}resetFilterableAttributes(){return this.#c.delete({path:`indexes/${this.uid}/settings/filterable-attributes`})}async getSortableAttributes(){return await this.httpRequest.get({path:`indexes/${this.uid}/settings/sortable-attributes`})}updateSortableAttributes(t){return this.#c.put({path:`indexes/${this.uid}/settings/sortable-attributes`,body:t})}resetSortableAttributes(){return this.#c.delete({path:`indexes/${this.uid}/settings/sortable-attributes`})}async getSearchableAttributes(){return await this.httpRequest.get({path:`indexes/${this.uid}/settings/searchable-attributes`})}updateSearchableAttributes(t){return this.#c.put({path:`indexes/${this.uid}/settings/searchable-attributes`,body:t})}resetSearchableAttributes(){return this.#c.delete({path:`indexes/${this.uid}/settings/searchable-attributes`})}async getDisplayedAttributes(){return await this.httpRequest.get({path:`indexes/${this.uid}/settings/displayed-attributes`})}updateDisplayedAttributes(t){return this.#c.put({path:`indexes/${this.uid}/settings/displayed-attributes`,body:t})}resetDisplayedAttributes(){return this.#c.delete({path:`indexes/${this.uid}/settings/displayed-attributes`})}async getTypoTolerance(){return await this.httpRequest.get({path:`indexes/${this.uid}/settings/typo-tolerance`})}updateTypoTolerance(t){return this.#c.patch({path:`indexes/${this.uid}/settings/typo-tolerance`,body:t})}resetTypoTolerance(){return this.#c.delete({path:`indexes/${this.uid}/settings/typo-tolerance`})}async getFaceting(){return await this.httpRequest.get({path:`indexes/${this.uid}/settings/faceting`})}updateFaceting(t){return this.#c.patch({path:`indexes/${this.uid}/settings/faceting`,body:t})}resetFaceting(){return this.#c.delete({path:`indexes/${this.uid}/settings/faceting`})}async getSeparatorTokens(){return await this.httpRequest.get({path:`indexes/${this.uid}/settings/separator-tokens`})}updateSeparatorTokens(t){return this.#c.put({path:`indexes/${this.uid}/settings/separator-tokens`,body:t})}resetSeparatorTokens(){return this.#c.delete({path:`indexes/${this.uid}/settings/separator-tokens`})}async getNonSeparatorTokens(){return await this.httpRequest.get({path:`indexes/${this.uid}/settings/non-separator-tokens`})}updateNonSeparatorTokens(t){return this.#c.put({path:`indexes/${this.uid}/settings/non-separator-tokens`,body:t})}resetNonSeparatorTokens(){return this.#c.delete({path:`indexes/${this.uid}/settings/non-separator-tokens`})}async getDictionary(){return await this.httpRequest.get({path:`indexes/${this.uid}/settings/dictionary`})}updateDictionary(t){return this.#c.put({path:`indexes/${this.uid}/settings/dictionary`,body:t})}resetDictionary(){return this.#c.delete({path:`indexes/${this.uid}/settings/dictionary`})}async getProximityPrecision(){return await this.httpRequest.get({path:`indexes/${this.uid}/settings/proximity-precision`})}updateProximityPrecision(t){return this.#c.put({path:`indexes/${this.uid}/settings/proximity-precision`,body:t})}resetProximityPrecision(){return this.#c.delete({path:`indexes/${this.uid}/settings/proximity-precision`})}async getEmbedders(){return await this.httpRequest.get({path:`indexes/${this.uid}/settings/embedders`})}updateEmbedders(t){return this.#c.patch({path:`indexes/${this.uid}/settings/embedders`,body:t})}resetEmbedders(){return this.#c.delete({path:`indexes/${this.uid}/settings/embedders`})}async getSearchCutoffMs(){return await this.httpRequest.get({path:`indexes/${this.uid}/settings/search-cutoff-ms`})}updateSearchCutoffMs(t){return this.#c.put({path:`indexes/${this.uid}/settings/search-cutoff-ms`,body:t})}resetSearchCutoffMs(){return this.#c.delete({path:`indexes/${this.uid}/settings/search-cutoff-ms`})}async getLocalizedAttributes(){return await this.httpRequest.get({path:`indexes/${this.uid}/settings/localized-attributes`})}updateLocalizedAttributes(t){return this.#c.put({path:`indexes/${this.uid}/settings/localized-attributes`,body:t})}resetLocalizedAttributes(){return this.#c.delete({path:`indexes/${this.uid}/settings/localized-attributes`})}async getFacetSearch(){return await this.httpRequest.get({path:`indexes/${this.uid}/settings/facet-search`})}updateFacetSearch(t){return this.#c.put({path:`indexes/${this.uid}/settings/facet-search`,body:t})}resetFacetSearch(){return this.#c.delete({path:`indexes/${this.uid}/settings/facet-search`})}async getPrefixSearch(){return await this.httpRequest.get({path:`indexes/${this.uid}/settings/prefix-search`})}updatePrefixSearch(t){return this.#c.put({path:`indexes/${this.uid}/settings/prefix-search`,body:t})}resetPrefixSearch(){return this.#c.delete({path:`indexes/${this.uid}/settings/prefix-search`})}async getChat(){return await this.httpRequest.get({path:`indexes/${this.uid}/settings/chat`})}updateChat(t){return this.#c.patch({path:`indexes/${this.uid}/settings/chat`,body:t})}}class P{#u;constructor(t){this.#u=t}async getBatch(t){return await this.#u.get({path:`batches/${t}`})}async getBatches(t){return await this.#u.get({path:"batches",params:t})}}class D{#u;#l;constructor(t,e){this.#u=t,this.#l=e}async get(){return await this.#u.get({path:`chats/${this.#l}/settings`})}async update(t){return await this.#u.patch({path:`chats/${this.#l}/settings`,body:t})}async reset(){await this.#u.delete({path:`chats/${this.#l}/settings`})}async streamCompletion(t){if(!t.stream)throw Error("The SDK only supports streaming");return await this.#u.postStream({path:`chats/${this.#l}/chat/completions`,body:t})}}var O=t.i(907968);let F=new class{config;httpRequest;#g;get tasks(){return this.#g}#y;get batches(){return this.#y}#c;constructor(t){this.config=t,this.httpRequest=new S(t),this.#g=new E(this.httpRequest,t.defaultWaitOptions),this.#y=new P(this.httpRequest),this.#c=C(this.httpRequest,this.tasks)}index(t){return new I(this.config,t)}async getIndex(t){return new I(this.config,t).fetchInfo()}async getRawIndex(t){return new I(this.config,t).getRawInfo()}async getIndexes(t){let e=await this.getRawIndexes(t),s=e.results.map(t=>new I(this.config,t.uid,t.primaryKey));return{...e,results:s}}async getRawIndexes(t){return await this.httpRequest.get({path:"indexes",params:t})}createIndex(t,e){return I.create(t,e,this.config)}updateIndex(t,e){return new I(this.config,t).update(e)}deleteIndex(t){return new I(this.config,t).delete()}async deleteIndexIfExists(t){try{return await this.deleteIndex(t),!0}catch(t){if(t?.cause?.code==="index_not_found")return!1;throw t}}swapIndexes(t){return this.#c.post({path:"swap-indexes",body:t})}async multiSearch(t,e){return await this.httpRequest.post({path:"multi-search",body:t,extraRequestInit:e})}chat(t){return new D(this.httpRequest,t)}async getChatWorkspaces(){return await this.httpRequest.get({path:"chats"})}async getWebhooks(){return await this.httpRequest.get({path:"webhooks"})}async getWebhook(t){return await this.httpRequest.get({path:`webhooks/${t}`})}async createWebhook(t){return await this.httpRequest.post({path:"webhooks",body:t})}async updateWebhook(t,e){return await this.httpRequest.patch({path:`webhooks/${t}`,body:e})}async deleteWebhook(t){await this.httpRequest.delete({path:`webhooks/${t}`})}async getNetwork(){return await this.httpRequest.get({path:"network"})}async updateNetwork(t){return await this.httpRequest.patch({path:"network",body:t})}async getKeys(t){let e=await this.httpRequest.get({path:"keys",params:t});return e.results=e.results.map(t=>({...t,createdAt:new Date(t.createdAt),updatedAt:new Date(t.updatedAt)})),e}async getKey(t){return await this.httpRequest.get({path:`keys/${t}`})}async createKey(t){return await this.httpRequest.post({path:"keys",body:t})}async updateKey(t,e){return await this.httpRequest.patch({path:`keys/${t}`,body:e})}async deleteKey(t){await this.httpRequest.delete({path:`keys/${t}`})}async health(){return await this.httpRequest.get({path:"health"})}async isHealthy(){try{let{status:t}=await this.health();return"available"===t}catch{return!1}}async getStats(){return await this.httpRequest.get({path:"stats"})}async getVersion(){return await this.httpRequest.get({path:"version"})}createDump(){return this.#c.post({path:"dumps"})}createSnapshot(){return this.#c.post({path:"snapshots"})}async getExperimentalFeatures(){return await this.httpRequest.get({path:"experimental-features"})}async updateExperimentalFeatures(t){return await this.httpRequest.patch({path:"experimental-features",body:t})}}({host:process.env.MEILISEARCH_HOST||"http://localhost:7700",apiKey:process.env.MEILISEARCH_API_KEY});async function N(t){try{let e=t.nextUrl.searchParams,s=e.get("q")||"",i=parseInt(e.get("limit")||"20");if(!s.trim())return m.NextResponse.json({hits:[],total:0});let a=await F.index("products").search(s,{limit:i,attributesToHighlight:["title"]});if(0===a.hits.length){let t=(await (0,O.getAllProducts)()).filter(t=>t.title.toLowerCase().includes(s.toLowerCase())||t.category.toLowerCase().includes(s.toLowerCase())).slice(0,i);return m.NextResponse.json({hits:t.map(t=>({...t,_formatted:{title:t.title}})),total:t.length})}return m.NextResponse.json(a)}catch(e){console.error("Search error:",e);try{let e=t.nextUrl.searchParams,s=e.get("q")||"",i=parseInt(e.get("limit")||"20"),a=(await (0,O.getAllProducts)()).filter(t=>t.title.toLowerCase().includes(s.toLowerCase())||t.category.toLowerCase().includes(s.toLowerCase())).slice(0,i);return m.NextResponse.json({hits:a,total:a.length})}catch(t){return console.error("Fallback search error:",t),m.NextResponse.json({error:"Search unavailable"},{status:500})}}}async function j(){try{let t=(await (0,O.getAllProducts)()).map(t=>({id:t.id,title:t.title,category:t.category,price:t.price,rating:t.rating,reviews:t.reviews,inStock:t.inStock})),e=await F.index("products").addDocuments(t);return await F.index("products").updateSearchableAttributes(["title","category"]),m.NextResponse.json({success:!0,task:e})}catch(t){return console.error("Indexing error:",t),m.NextResponse.json({error:"Failed to index products"},{status:500})}}t.s(["GET",()=>N,"POST",()=>j],988065);var H=t.i(988065);let M=new e.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/search/route",pathname:"/api/search",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/search/route.ts",nextConfigOutput:"",userland:H}),{workAsyncStorage:K,workUnitAsyncStorage:L,serverHooks:_}=M;function U(){return(0,i.patchFetch)({workAsyncStorage:K,workUnitAsyncStorage:L})}async function B(t,e,i){M.isDev&&(0,a.addRequestMeta)(t,"devRequestTimingInternalsEnd",process.hrtime.bigint());let m="/api/search/route";m=m.replace(/\/index$/,"")||"/";let b=await M.prepare(t,e,{srcPage:m,multiZoneDraftMode:!1});if(!b)return e.statusCode=400,e.end("Bad Request"),null==i.waitUntil||i.waitUntil.call(i,Promise.resolve()),null;let{buildId:x,params:f,nextConfig:T,parsedUrl:k,isDraftMode:$,prerenderManifest:v,routerServerContext:S,isOnDemandRevalidate:A,revalidateOnlyGenerated:W,resolvedPathname:E,clientReferenceManifest:C,serverActionsManifest:I}=b,P=(0,u.normalizeAppPath)(m),D=!!(v.dynamicRoutes[P]||v.routes[E]),O=async()=>((null==S?void 0:S.render404)?await S.render404(t,e,k,!1):e.end("This page could not be found"),null);if(D&&!$){let t=!!v.routes[E],e=v.dynamicRoutes[P];if(e&&!1===e.fallback&&!t){if(T.experimental.adapterPath)return await O();throw new w.NoFallbackError}}let F=null;!D||M.isDev||$||(F="/index"===(F=E)?"/":F);let N=!0===M.isDev||!D,j=D&&!N;I&&C&&(0,n.setReferenceManifestsSingleton)({page:m,clientReferenceManifest:C,serverActionsManifest:I,serverModuleMap:(0,h.createServerModuleMap)({serverActionsManifest:I})});let H=t.method||"GET",K=(0,r.getTracer)(),L=K.getActiveScopeSpan(),_={params:f,prerenderManifest:v,renderOpts:{experimental:{authInterrupts:!!T.experimental.authInterrupts},cacheComponents:!!T.cacheComponents,supportsDynamicResponse:N,incrementalCache:(0,a.getRequestMeta)(t,"incrementalCache"),cacheLifeProfiles:T.cacheLife,waitUntil:i.waitUntil,onClose:t=>{e.on("close",t)},onAfterTaskError:void 0,onInstrumentationRequestError:(e,s,i)=>M.onRequestError(t,e,i,S)},sharedContext:{buildId:x}},U=new o.NodeNextRequest(t),B=new o.NodeNextResponse(e),z=d.NextRequestAdapter.fromNodeNextRequest(U,(0,d.signalFromNodeResponse)(e));try{let n=async t=>M.handle(z,_).finally(()=>{if(!t)return;t.setAttributes({"http.status_code":e.statusCode,"next.rsc":!1});let s=K.getRootSpanAttributes();if(!s)return;if(s.get("next.span_type")!==p.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${s.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let i=s.get("next.route");if(i){let e=`${H} ${i}`;t.setAttributes({"next.route":i,"http.route":i,"next.span_name":e}),t.updateName(e)}else t.updateName(`${H} ${m}`)}),h=!!(0,a.getRequestMeta)(t,"minimalMode"),u=async a=>{var r,u;let o=async({previousCacheEntry:s})=>{try{if(!h&&A&&W&&!s)return e.statusCode=404,e.setHeader("x-nextjs-cache","REVALIDATED"),e.end("This page could not be found"),null;let r=await n(a);t.fetchMetrics=_.renderOpts.fetchMetrics;let u=_.renderOpts.pendingWaitUntil;u&&i.waitUntil&&(i.waitUntil(u),u=void 0);let o=_.renderOpts.collectedTags;if(!D)return await (0,l.sendResponse)(U,B,r,_.renderOpts.pendingWaitUntil),null;{let t=await r.blob(),e=(0,g.toNodeOutgoingHttpHeaders)(r.headers);o&&(e[R.NEXT_CACHE_TAGS_HEADER]=o),!e["content-type"]&&t.type&&(e["content-type"]=t.type);let s=void 0!==_.renderOpts.collectedRevalidate&&!(_.renderOpts.collectedRevalidate>=R.INFINITE_CACHE)&&_.renderOpts.collectedRevalidate,i=void 0===_.renderOpts.collectedExpire||_.renderOpts.collectedExpire>=R.INFINITE_CACHE?void 0:_.renderOpts.collectedExpire;return{value:{kind:q.CachedRouteKind.APP_ROUTE,status:r.status,body:Buffer.from(await t.arrayBuffer()),headers:e},cacheControl:{revalidate:s,expire:i}}}}catch(e){throw(null==s?void 0:s.isStale)&&await M.onRequestError(t,e,{routerKind:"App Router",routePath:m,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isStaticGeneration:j,isOnDemandRevalidate:A})},S),e}},d=await M.handleResponse({req:t,nextConfig:T,cacheKey:F,routeKind:s.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:v,isRoutePPREnabled:!1,isOnDemandRevalidate:A,revalidateOnlyGenerated:W,responseGenerator:o,waitUntil:i.waitUntil,isMinimalMode:h});if(!D)return null;if((null==d||null==(r=d.value)?void 0:r.kind)!==q.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(u=d.value)?void 0:u.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});h||e.setHeader("x-nextjs-cache",A?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),$&&e.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,g.fromNodeOutgoingHttpHeaders)(d.value.headers);return h&&D||p.delete(R.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||e.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,y.getCacheControlHeader)(d.cacheControl)),await (0,l.sendResponse)(U,B,new Response(d.value.body,{headers:p,status:d.value.status||200})),null};L?await u(L):await K.withPropagatedContext(t.headers,()=>K.trace(p.BaseServerSpan.handleRequest,{spanName:`${H} ${m}`,kind:r.SpanKind.SERVER,attributes:{"http.method":H,"http.target":t.url}},u))}catch(e){if(e instanceof w.NoFallbackError||await M.onRequestError(t,e,{routerKind:"App Router",routePath:P,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isStaticGeneration:j,isOnDemandRevalidate:A})}),D)throw e;return await (0,l.sendResponse)(U,B,new Response(null,{status:500})),null}}t.s(["handler",()=>B,"patchFetch",()=>U,"routeModule",()=>M,"serverHooks",()=>_,"workAsyncStorage",()=>K,"workUnitAsyncStorage",()=>L],751604)}];

//# sourceMappingURL=node_modules_next_dist_esm_build_templates_app-route_44d9a245.js.map