module.exports=[130854,a=>{"use strict";let b,c,d;var e=a.i(572131);let f=a=>{let b,c=new Set,d=(a,d)=>{let e="function"==typeof a?a(b):a;if(!Object.is(e,b)){let a=b;b=(null!=d?d:"object"!=typeof e||null===e)?e:Object.assign({},b,e),c.forEach(c=>c(b,a))}},e=()=>b,f={setState:d,getState:e,getInitialState:()=>g,subscribe:a=>(c.add(a),()=>c.delete(a))},g=b=a(d,e,f);return f},g=a=>{let b=a?f(a):f,c=a=>(function(a,b=a=>a){let c=e.default.useSyncExternalStore(a.subscribe,e.default.useCallback(()=>b(a.getState()),[a,b]),e.default.useCallback(()=>b(a.getInitialState()),[a,b]));return e.default.useDebugValue(c),c})(b,a);return Object.assign(c,b),c},h=a=>b=>{try{let c=a(b);if(c instanceof Promise)return c;return{then:a=>h(a)(c),catch(a){return this}}}catch(a){return{then(a){return this},catch:b=>h(b)(a)}}},i=(b?g(b):g)((c=(a,b)=>({items:[],addItem:b=>a(a=>a.items.find(a=>a.id===b.id)?{items:a.items.map(a=>a.id===b.id?{...a,quantity:a.quantity+1}:a)}:{items:[...a.items,{...b,quantity:1}]}),removeItem:b=>a(a=>({items:a.items.filter(a=>a.id!==b)})),updateQuantity:(b,c)=>a(a=>({items:a.items.map(a=>a.id===b?{...a,quantity:c}:a)})),clearCart:()=>a({items:[]}),getTotalItems:()=>b().items.reduce((a,b)=>a+b.quantity,0),getTotalPrice:()=>b().items.reduce((a,b)=>a+b.price*b.quantity,0)}),d={name:"midas-cart"},(a,b,e)=>{let f,g={storage:function(a,b){let c;try{c=a()}catch(a){return}return{getItem:a=>{var b;let d=a=>null===a?null:JSON.parse(a,void 0),e=null!=(b=c.getItem(a))?b:null;return e instanceof Promise?e.then(d):d(e)},setItem:(a,b)=>c.setItem(a,JSON.stringify(b,void 0)),removeItem:a=>c.removeItem(a)}}(()=>localStorage),partialize:a=>a,version:0,merge:(a,b)=>({...b,...a}),...d},i=!1,j=new Set,k=new Set,l=g.storage;if(!l)return c((...b)=>{console.warn(`[zustand persist middleware] Unable to update item '${g.name}', the given storage is currently unavailable.`),a(...b)},b,e);let m=()=>{let a=g.partialize({...b()});return l.setItem(g.name,{state:a,version:g.version})},n=e.setState;e.setState=(a,b)=>(n(a,b),m());let o=c((...b)=>(a(...b),m()),b,e);e.getInitialState=()=>o;let p=()=>{var c,d;if(!l)return;i=!1,j.forEach(a=>{var c;return a(null!=(c=b())?c:o)});let e=(null==(d=g.onRehydrateStorage)?void 0:d.call(g,null!=(c=b())?c:o))||void 0;return h(l.getItem.bind(l))(g.name).then(a=>{if(a)if("number"!=typeof a.version||a.version===g.version)return[!1,a.state];else{if(g.migrate){let b=g.migrate(a.state,a.version);return b instanceof Promise?b.then(a=>[!0,a]):[!0,b]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(c=>{var d;let[e,h]=c;if(a(f=g.merge(h,null!=(d=b())?d:o),!0),e)return m()}).then(()=>{null==e||e(f,void 0),f=b(),i=!0,k.forEach(a=>a(f))}).catch(a=>{null==e||e(void 0,a)})};return e.persist={setOptions:a=>{g={...g,...a},a.storage&&(l=a.storage)},clearStorage:()=>{null==l||l.removeItem(g.name)},getOptions:()=>g,rehydrate:()=>p(),hasHydrated:()=>i,onHydrate:a=>(j.add(a),()=>{j.delete(a)}),onFinishHydration:a=>(k.add(a),()=>{k.delete(a)})},g.skipHydration||p(),f||o}));a.s(["useCart",0,i],130854)},112732,810788,a=>{"use strict";var b,c="clover";"".concat("https://js.stripe.com","/").concat(c,"/stripe.js");var d=function(a,b){a&&a._registerWrapper&&a._registerWrapper({name:"stripe-js",version:"8.6.0",startTime:b})},e=null,f=function(a,b,e){if(null===a)return null;var f,g=b[0].match(/^pk_test/),h=3===(f=a.version)?"v3":f;g&&h!==c&&console.warn("Stripe.js@".concat(h," was loaded on the page, but @stripe/stripe-js@").concat("8.6.0"," expected Stripe.js@").concat(c,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var i=a.apply(void 0,b);return d(i,e),i},g=!1,h=function(){return b?b:b=(null!==e?e:(e=new Promise(function(a,b){a(null)})).catch(function(a){return e=null,Promise.reject(a)})).catch(function(a){return b=null,Promise.reject(a)})};Promise.resolve().then(function(){return h()}).catch(function(a){g||console.warn(a)});var i=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];g=!0;var d=Date.now();return h().then(function(a){return f(a,b,d)})};a.s(["loadStripe",()=>i],810788),a.s([],112732)},11532,a=>{"use strict";var b=a.i(187924);a.i(112732);var c=a.i(810788),d=a.i(130854),e=a.i(572131);let f=(0,c.loadStripe)("REPLACE_WITH_STRIPE_PUBLISHABLE_KEY");function g(){let{items:a,clearCart:c}=(0,d.useCart)(),[g,h]=(0,e.useState)(!1),[i,j]=(0,e.useState)("cart"),[k,l]=(0,e.useState)({name:"",street1:"",city:"",state:"",zip:"",country:"US"}),[m,n]=(0,e.useState)([]),[o,p]=(0,e.useState)(""),[q,r]=(0,e.useState)(!1);(0,e.useEffect)(()=>{0===a.length&&(window.location.href="/cart")},[a]);let s=async()=>{if(k.name&&k.street1&&k.city&&k.state&&k.zip){r(!0);try{let b=await fetch("/api/shipping",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({address:k,items:a.map(a=>({title:a.title,quantity:a.quantity,price:a.price}))})}),c=await b.json();c.shippingOptions&&(n(c.shippingOptions),p(c.shippingOptions[0]?.id||""))}catch(a){console.error("Shipping calculation failed:",a)}r(!1)}},t=async()=>{h(!0),await f,a.reduce((a,b)=>a+b.price*b.quantity,0);let b=m.find(a=>a.id===o);b?.cost;let c=await fetch("/api/stripe/checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:a.map(a=>({priceId:a.stripePriceId,quantity:a.quantity}))})}),{url:d}=await c.json();d?window.location.href=d:(alert("Failed to create checkout session"),h(!1))},u=a.reduce((a,b)=>a+b.price*b.quantity,0),v=m.find(a=>a.id===o),w=v?.cost||0,x=u+w;return"cart"===i?(0,b.jsxs)("div",{className:"max-w-2xl mx-auto p-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Checkout"}),(0,b.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg mb-6",children:[(0,b.jsx)("h2",{className:"font-semibold mb-4",children:"Order Summary"}),a.map(a=>(0,b.jsxs)("div",{className:"flex justify-between py-2",children:[(0,b.jsxs)("span",{children:[a.title," × ",a.quantity]}),(0,b.jsxs)("span",{children:["$",(a.price*a.quantity).toFixed(2)]})]},a.id)),(0,b.jsxs)("div",{className:"border-t pt-4 font-bold text-lg",children:["Subtotal: $",u.toFixed(2)]})]}),(0,b.jsx)("button",{onClick:()=>j("shipping"),className:"w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700",children:"Continue to Shipping"})]}):(0,b.jsxs)("div",{className:"max-w-2xl mx-auto p-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Checkout"}),(0,b.jsxs)("div",{className:"bg-white border rounded-lg p-6 mb-6",children:[(0,b.jsx)("h2",{className:"font-semibold mb-4",children:"Shipping Address"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("input",{type:"text",placeholder:"Full Name",value:k.name,onChange:a=>l({...k,name:a.target.value}),className:"w-full p-2 border rounded",required:!0}),(0,b.jsx)("input",{type:"text",placeholder:"Street Address",value:k.street1,onChange:a=>l({...k,street1:a.target.value}),className:"w-full p-2 border rounded",required:!0}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)("input",{type:"text",placeholder:"City",value:k.city,onChange:a=>l({...k,city:a.target.value}),className:"p-2 border rounded",required:!0}),(0,b.jsx)("input",{type:"text",placeholder:"State",value:k.state,onChange:a=>l({...k,state:a.target.value}),className:"p-2 border rounded",required:!0})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)("input",{type:"text",placeholder:"ZIP Code",value:k.zip,onChange:a=>l({...k,zip:a.target.value}),className:"p-2 border rounded",required:!0}),(0,b.jsxs)("select",{value:k.country,onChange:a=>l({...k,country:a.target.value}),className:"p-2 border rounded",title:"Country",children:[(0,b.jsx)("option",{value:"US",children:"United States"}),(0,b.jsx)("option",{value:"CA",children:"Canada"})]})]}),(0,b.jsx)("button",{onClick:s,disabled:q,className:"w-full bg-green-600 text-white py-2 rounded hover:bg-green-700 disabled:opacity-50",children:q?"Calculating...":"Calculate Shipping"})]})]}),(0,b.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg mb-6",children:[(0,b.jsx)("h2",{className:"font-semibold mb-4",children:"Order Summary"}),a.map(a=>(0,b.jsxs)("div",{className:"flex justify-between py-2",children:[(0,b.jsxs)("span",{children:[a.title," × ",a.quantity]}),(0,b.jsxs)("span",{children:["$",(a.price*a.quantity).toFixed(2)]})]},a.id)),m.length>0&&(0,b.jsxs)("div",{className:"border-t pt-4 mt-4",children:[(0,b.jsx)("h3",{className:"font-semibold mb-2",children:"Shipping Options"}),(0,b.jsx)("div",{className:"space-y-2",children:m.map(a=>(0,b.jsxs)("label",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)("input",{type:"radio",name:"shipping",value:a.id,checked:o===a.id,onChange:a=>p(a.target.value),className:"mr-2"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:a.name}),(0,b.jsxs)("div",{className:"text-sm text-gray-600",children:[a.estimatedDays," days"]})]})]}),(0,b.jsxs)("div",{className:"font-medium",children:["$",a.cost.toFixed(2)]})]},a.id))}),(0,b.jsxs)("div",{className:"border-t pt-2 mt-2 font-semibold",children:["Shipping: $",w.toFixed(2)]})]}),(0,b.jsxs)("div",{className:"border-t pt-4 font-bold text-lg",children:["Total: $",x.toFixed(2)]})]}),m.length>0&&(0,b.jsx)("button",{onClick:t,disabled:g||!o,className:"w-full bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 disabled:opacity-50",children:g?"Processing...":"Pay with Stripe"})]})}a.s(["default",()=>g])}];

//# sourceMappingURL=_bac06ddb._.js.map