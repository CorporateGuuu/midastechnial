{"version":3,"sources":["turbopack:///[project]/node_modules/pusher/package.json","turbopack:///[project]/app/orders/page.tsx"],"sourcesContent":["{\"name\":\"pusher\",\"description\":\"Node.js client to interact with the Pusher Channels REST API\",\"version\":\"5.2.0\",\"author\":\"Pusher <support@pusher.com>\",\"contributors\":[{\"name\":\"fabrik42\",\"email\":\"fabrik42@gmail.com\"},{\"name\":\"Jaewoong Kim\",\"email\":\"jwoongkim@gmail.com\"},{\"name\":\"Phil Leggetter\",\"email\":\"phil@leggetter.co.uk\"},{\"name\":\"Paweł Ledwoń\",\"email\":\"me@ludvik.pl\"}],\"dependencies\":{\"abort-controller\":\"^3.0.0\",\"is-base64\":\"^1.1.0\",\"node-fetch\":\"^2.6.1\",\"tweetnacl\":\"^1.0.0\",\"tweetnacl-util\":\"^0.15.0\",\"@types/node-fetch\":\"^2.5.7\"},\"devDependencies\":{\"@types/node\":\"^14.14.6\",\"eslint\":\"^7.11.0\",\"expect.js\":\"=0.3.1\",\"express\":\"^4.17.1\",\"https-proxy-agent\":\"^5.0.0\",\"mocha\":\"^7.2.0\",\"nock\":\"^12.0.3\",\"prettier\":\"2.1.2\",\"sinon\":\"=1.10.2\",\"webpack\":\"^4.42.1\",\"webpack-cli\":\"^3.3.11\"},\"scripts\":{\"local-test\":\"npx mocha 'tests/integration/**/*.js'\",\"test\":\"npx mocha 'tests/{integration,remote}/**/*.js'\",\"lint\":\"npx eslint . && npx prettier --check .\",\"format\":\"npx prettier --write .\"},\"keywords\":[\"pusher\",\"websockets\",\"realtime\"],\"license\":\"MIT\",\"repository\":\"git://github.com/pusher/pusher-http-node\",\"main\":\"lib/pusher\",\"typings\":\"index.d.ts\",\"engines\":{\"node\":\">= 4.0.0\"}}","\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { useSession } from \"next-auth/react\";\nimport { pusherClient } from \"@/lib/pusher\";\nimport { format } from \"date-fns\";\n\ninterface TrackingUpdate {\n  status: string;\n  description: string;\n  location: string | null;\n  timestamp: string;\n}\n\nexport default function OrdersPage() {\n  const { data: session, status } = useSession();\n  const [orders, setOrders] = useState<any[]>([]);\n  const [tracking, setTracking] = useState<Record<string, TrackingUpdate>>({});\n\n  useEffect(() => {\n    if (status !== \"authenticated\" || !session?.user?.email) return;\n\n    // Fetch initial orders\n    fetch(\"/api/orders\")\n      .then((r) => r.json())\n      .then(setOrders);\n\n    // Subscribe to each order\n    orders.forEach((order) => {\n      const channel = pusherClient?.subscribe(`order-${order.id}`);\n      channel?.bind(\"tracking-update\", (data: TrackingUpdate) => {\n        setTracking((prev) => ({ ...prev, [order.id]: data }));\n      });\n    });\n\n    return () => {\n      orders.forEach((order) => pusherClient?.unsubscribe(`order-${order.id}`));\n    };\n  }, [orders.length, session, status]);\n\n  if (status === \"loading\") {\n    return <div className=\"text-center py-20\">Loading...</div>;\n  }\n\n  if (status !== \"authenticated\" || !session?.user?.email) {\n    return <div>Please log in to view orders.</div>;\n  }\n\n  if (orders.length === 0) {\n    return <div className=\"text-center py-20\">No orders yet.</div>;\n  }\n\n  return (\n    <div className=\"max-w-4xl mx-auto p-6\">\n      <h1 className=\"text-3xl font-bold mb-8\">Order History</h1>\n      <div className=\"space-y-6\">\n        {orders.map((order) => {\n          const live = tracking[order.id];\n          return (\n            <div key={order.id} className=\"border rounded-lg p-6\">\n              <div>\n                <p className=\"font-semibold\">Order #{order.id.slice(0, 8)}</p>\n                <p className=\"text-sm text-gray-600\">\n                  {format(new Date(order.createdAt), \"PPP\")}\n                </p>\n              </div>\n              <div className=\"flex justify-between items-center mb-2 mt-2\">\n                <span className={`px-3 py-1 rounded-full text-sm ${\n                  live?.status === \"shipped\" ? \"bg-blue-100 text-blue-800\" :\n                  live?.status === \"delivered\" ? \"bg-green-100 text-green-800\" :\n                  order.status === \"shipped\" ? \"bg-blue-100 text-blue-800\" :\n                  order.status === \"delivered\" ? \"bg-green-100 text-green-800\" :\n                  \"bg-yellow-100 text-yellow-800\"\n                }`}>\n                  {live?.status || order.status}\n                </span>\n                {order.trackingNumber && (\n                  <a\n                    href={order.trackingUrl}\n                    target=\"_blank\"\n                    className=\"text-primary text-sm hover:underline\"\n                  >\n                    Track Package → {order.trackingNumber}\n                  </a>\n                )}\n              </div>\n              {order.trackingNumber && live && (\n                <div className=\"mt-1 text-sm text-gray-600\">\n                  {live.description} • {live.location && `${live.location}, `}{format(new Date(live.timestamp), \"p\")}\n                </div>\n              )}\n              <div className=\"space-y-2 mt-4\">\n                {JSON.parse(order.items).map((item: any, i: number) => (\n                  <div key={i} className=\"flex justify-between text-sm\">\n                    <span>\n                      {item.title} × {item.quantity}\n                    </span>\n                    <span>${(item.price * item.quantity).toFixed(2)}</span>\n                  </div>\n                ))}\n              </div>\n              <div className=\"border-t mt-4 pt-4 font-bold\">\n                Total: ${order.total.toFixed(2)}\n              </div>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}